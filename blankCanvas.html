<!doctype html>

<body>
    <canvas id="gameCanvas" width="1400" height="740"></canvas>
    <script>
        var canvas, canvasContext;

        window.onload = function () {
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');
            imageAssets = loadImgAssets();
            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);


            setInterval(mainloop, 1000 / 50);
        }

        var playerXsource = 0;
        var playerYsource = 0;
        var playerXpos = 850;
        var playerYpos = 470;
        var playerXspeed = 5;
        var playerYspeed = 5;
        const PLAYER_SIZE = 40;
        const PLAYER_HEIGHT = 50;
        const PLAYER_WIDTH = 50;
        const D_KEY = 68;
        const A_KEY = 65;
        const SPACE_KEY = 32;

        // player spriteSheet variables
        var playerSpriteArray = [];
        const PLAYER_SPRITES = 6;
        var playerSpriteNum = 0;
        var playerSpriteSheetCols = 0;
        var antiFrameRate = 0.1;

        var background1 = new Image();
        background1.src = "background.png";

        var aKeyPressed = false;
        var dKeyPressed = false;
        var spaceKeyPressed = false;

        function mainloop() {
            drawImg(background1, 0, 0, canvas.width, canvas.height);
            // colorRect(0, 0, canvas.width, canvas.height, 'lightblue'); // stuff
            drawSprite(imageAssets.player, playerXsource, playerYsource, PLAYER_WIDTH, PLAYER_HEIGHT, playerXpos,
                playerYpos, PLAYER_WIDTH, PLAYER_HEIGHT); //draws Player Image

            playerMove();
            PlayerMove();
        }

        function drawImg(src,x,y,w,h) {
            canvasContext.drawImage(src,x,y,w,h)
        }


        function colorRect(x, y, w, h, c) {
            canvasContext.fillStyle = c;
            canvasContext.fillRect(x, y, w, h);
        }

        function drawSprite(img, sX, sY, sW, sH, dX, dY, dW, dH) {
            canvasContext.drawImage(img, sX, sY, sW, sH, dX, dY, dW, dH);
        } //end of drawImg function



        function keyPressed(evt) {
            console.log(evt.keyCode)
            if (evt.keyCode == D_KEY) {
                dKeyPressed = true;
            }
            if (evt.keyCode == A_KEY) {
                aKeyPressed = true;
            }
            if (evt.keyCode == SPACE_KEY) {
                spaceKeyPressed = true;
            }
        }

        function keyReleased(evt) {
            console.log(evt.keyCode)
            if (evt.keyCode == D_KEY) {
                dKeyPressed = false;
            }
            if (evt.keyCode == A_KEY) {
                aKeyPressed = false;
            }
            if (evt.keyCode == SPACE_KEY) {
                spaceKeyPressed = false;
            }
        }

        function PlayerMove() {
            if (dKeyPressed && playerXpos < canvas.width * .97) {
                playerXpos += playerXspeed;
            }

            if (aKeyPressed && playerXpos > canvas.width * .001) {
                playerXpos -= playerXspeed;
            }

            if (spaceKeyPressed && playerYpos >= canvas.height * .905) {
                playerYspeed = -25;
            }

            playerYpos += playerYspeed;
            playerYspeed += 1;

            if (playerYpos + PLAYER_SIZE >= canvas.height) {
                playerYpos = canvas.height - PLAYER_SIZE;
            }

        }

        function playerMove() {
            playerXsource = playerSpriteArray[Math.floor(playerSpriteNum)][0];
            playerYsource = playerSpriteArray[Math.floor(playerSpriteNum)][1];

            if (aKeyPressed) {
                playerSpriteNum += antiFrameRate;
                playerXpos -= playerXspeed;
                if (playerSpriteNum < 0 || playerSpriteNum > 4) {
                    playerSpriteNum = 0;
                }
            }

            if (dKeyPressed) {
                playerSpriteNum += antiFrameRate;
                playerXpos += playerXspeed;
                if (playerSpriteNum > 5 || playerSpriteNum < 8) {
                    playerSpriteNum = 5;
                }
            }
        }

        for (i = 0; i < PLAYER_SPRITES; i++) {
            playerSpriteArray[i] = new Array(2);
            playerSpriteArray[i][0] = PLAYEDFR_WIDTHS * (i % 4);
            if (i != 0 && i % 3 == 0) {
                playerSpriteSheetCols++;
            }
            playerSpriteArray[i][1] = PLAYER_HEIGHT * playerSpriteSheetCols;
            console.log(playerSpriteArray[i]);
        }

        function playerAnimation() {
            playerSpriteNum += antiFrameRate;
            if (playerSpriteNum > 3) {
                playerSpriteNum = 5;
            }
            if (playerSpriteNum > 5) {
                playerSpriteNum = 3;
            }
        }

        function loadImgAssets() {
            imgs = {};
            imgs.player = new Image();
            imgs.player.src = "images.png";
            return imgs;
        }
    </script>
</body>